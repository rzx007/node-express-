!function(K){"use strict";var Q="ht",p=K[Q],x=Math,J=x.max,R=x.min,T=x.abs,F=x.atan2,v=(x.cos,x.sin,x.ceil),Y=p.Default,m=Y.getInternal(),b=p.List,O=m.Mat,r=m.getNodeRect,f=m.intersectionLineRect,H=Y.getDistance,o=Y.setEdgeType,$="left",g="right",L="top",X="bottom",A="edge.type",h="edge.gap",c="edge.center",u="edge.extend",N=function(h,i){return r(h,i).width},n=function(e,K){return r(e,K).height},W=function(F,O){return m.getEdgeHostPosition(F,O,"source")},C=function(_,F){return m.getEdgeHostPosition(_,F,"target")},t=function(S,_){var l=S.s(A),M=S.getEdgeGroup();if(M){var c=0;if(M.eachSiblingEdge(function(W){_.isVisible(W)&&W.s(A)==l&&c++}),c>1)return S.s(h)*(c-1)/2}return 0},z=function(Z,O){var F=Z.s(A),D=Z.isLooped();if(!Z.getEdgeGroup())return D?Z.s(h):0;var y,S=0,q=0,c=0;return Z.getEdgeGroup().getSiblings().each(function(v){v.each(function(Q){if(Q._40I===Z._40I&&Q.s(A)==F&&O.isVisible(Q)){var w=Q.s(h);y?(q+=c/2+w/2,c=w):(y=Q,c=w),Q===Z&&(S=q)}})}),D?q-S+c:S-q/2},d=function(D,Z){var U=Z.s("edge.corner.radius");return Y.toRoundedCorner(D,U)};m.addMethod(p.Style,{"edge.ripple.elevation":-20,"edge.ripple.size":1,"edge.ripple.both":!1,"edge.ripple.straight":!1,"edge.ripple.length":-1,"edge.corner.radius":-1,"edge.ortho":.5,"edge.flex":20,"edge.extend":20},!0),o("boundary",function(Y,R,S,B){B||(R=-R);var K,G=W(S,Y),n=C(S,Y),k=r(S,Y._40I),$=r(S,Y._41I),_=new O(F(n.y-G.y,n.x-G.x)),o=H(G,n),U=G.x,d=G.y;return K=_.tf(0,R),G={x:K.x+U,y:K.y+d},K=_.tf(o,R),n={x:K.x+U,y:K.y+d},K=f(G,n,k),K&&(G={x:K[0],y:K[1]}),K=f(G,n,$),K&&(n={x:K[0],y:K[1]}),{points:new b([G,n])}}),o("ripple",function(l,d,n,a){a||(d=-d);var D=W(n,l),y=C(n,l),L=H(D,y),V=R(l.s("edge.offset"),L/2),G=l.s("edge.ripple.size"),$=l.s("edge.ripple.length"),q=l.s("edge.ripple.both"),o=l.s(c),Z=l.s("edge.ripple.elevation"),s=new b,f=l.s("edge.ripple.straight")?null:new b,M=new O(F(y.y-D.y,y.x-D.x));a||(Z=-Z),L-=2*V,$>0&&(G=v(L/$));var z=L/G;f&&f.add(1);for(var j=0;G>j;j++)f&&f.add(3),0===j?s.add({x:V+z*j,y:o?0:d}):s.add({x:V+z*j,y:d}),s.add({x:V+z*j+z/2,y:Z+d}),q&&(Z=-Z);for(s.add({x:V+L,y:o?0:d}),j=0;j<s.size();j++){var A=M.tf(s.get(j));A.x+=D.x,A.y+=D.y,s.set(j,A)}return{points:s,segments:f}}),o("h.v",function(v,u,L){u=z(v,L);var w=new b,J=v.s(c),V=W(L,v),h=V.x,S=V.y,A=C(L,v),k=A.x,m=A.y,e=v._40I instanceof p.Edge,r=v._41I instanceof p.Edge,I=0,o=0,R=k-h,B=m-S;return J||(I=e?0:N(L,v._40I)/2,o=r?0:n(L,v._41I)/2),R>=0&&0>=B?(w.add({x:h+I,y:S+u}),w.add({x:k+u,y:S+u}),w.add({x:k+u,y:m+o})):0>=R&&B>=0?(w.add({x:h-I,y:S+u}),w.add({x:k+u,y:S+u}),w.add({x:k+u,y:m-o})):R>=0&&B>=0?(w.add({x:h+I,y:S+u}),w.add({x:k-u,y:S+u}),w.add({x:k-u,y:m-o})):(w.add({x:h-I,y:S+u}),w.add({x:k-u,y:S+u}),w.add({x:k-u,y:m+o})),d(w,v)}),o("v.h",function(B,V,S){V=z(B,S);var $=new b,l=B.s(c),L=W(S,B),g=L.x,h=L.y,r=C(S,B),Z=r.x,T=r.y,M=B._40I instanceof p.Edge,f=B._41I instanceof p.Edge,x=0,U=0,O=Z-g,X=T-h;return l||(x=f?0:N(S,B._41I)/2,U=M?0:n(S,B._40I)/2),O>=0&&0>=X?($.add({x:g+V,y:h-U}),$.add({x:g+V,y:T+V}),$.add({x:Z-x,y:T+V})):0>=O&&X>=0?($.add({x:g+V,y:h+U}),$.add({x:g+V,y:T+V}),$.add({x:Z+x,y:T+V})):O>=0&&X>=0?($.add({x:g-V,y:h+U}),$.add({x:g-V,y:T+V}),$.add({x:Z-x,y:T+V})):($.add({x:g-V,y:h-U}),$.add({x:g-V,y:T+V}),$.add({x:Z+x,y:T+V})),d($,B)}),o("ortho",function(G,f,k){var j=new b,M=G.s(c),t=G.s("edge.ortho"),s=G._40I,v=G._41I,F=W(k,G),q=F.x,R=F.y,z=C(k,G),y=z.x,m=z.y,g=y-q,Z=m-R,V=s instanceof p.Edge,w=v instanceof p.Edge,Q=M||V?0:N(k,s)/2,u=M||V?0:n(k,s)/2,h=M||w?0:N(k,v)/2,A=M||w?0:n(k,v)/2,i=(g-(Q+h)*(g>0?1:-1))*t,I=(Z-(u+A)*(Z>0?1:-1))*t;return T(g)<T(Z)?g>=0&&0>=Z?(j.add({x:q+f,y:R-u}),j.add({x:q+f,y:R+I+f-u}),j.add({x:y+f,y:R+I+f-u}),j.add({x:y+f,y:m+A})):0>=g&&Z>=0?(j.add({x:q+f,y:R+u}),j.add({x:q+f,y:R+I+f+u}),j.add({x:y+f,y:R+I+f+u}),j.add({x:y+f,y:m-A})):g>=0&&Z>=0?(j.add({x:q+f,y:R+u}),j.add({x:q+f,y:R+I-f+u}),j.add({x:y+f,y:R+I-f+u}),j.add({x:y+f,y:m-A})):(j.add({x:q+f,y:R-u}),j.add({x:q+f,y:R+I-f-u}),j.add({x:y+f,y:R+I-f-u}),j.add({x:y+f,y:m+A})):g>=0&&0>=Z?(j.add({x:q+Q,y:R+f}),j.add({x:q+i+f+Q,y:R+f}),j.add({x:q+i+f+Q,y:m+f}),j.add({x:y-h,y:m+f})):0>=g&&Z>=0?(j.add({x:q-Q,y:R+f}),j.add({x:q+i+f-Q,y:R+f}),j.add({x:q+i+f-Q,y:m+f}),j.add({x:y+h,y:m+f})):g>=0&&Z>=0?(j.add({x:q+Q,y:R+f}),j.add({x:q+i-f+Q,y:R+f}),j.add({x:q+i-f+Q,y:m+f}),j.add({x:y-h,y:m+f})):(j.add({x:q-Q,y:R+f}),j.add({x:q+i-f-Q,y:R+f}),j.add({x:q+i-f-Q,y:m+f}),j.add({x:y+h,y:m+f})),d(j,G)}),o("flex",function(L,q,M){var m=new b,z=L.s("edge.flex")+t(L,M),f=L.s(c),V=L._40I,I=L._41I,s=W(M,L),o=s.x,G=s.y,Z=C(M,L),h=Z.x,w=Z.y,S=V instanceof p.Edge,B=I instanceof p.Edge,Q=h-o,x=w-G,j=f||S?0:N(M,V)/2,R=f||S?0:n(M,V)/2,O=f||B?0:N(M,I)/2,E=f||B?0:n(M,I)/2,F=Q>0?z:-z,K=x>0?z:-z;return T(Q)<T(x)?Q>=0&&0>=x?(m.add({x:o+q,y:G-R}),m.add({x:o+q,y:G+K+q-R}),m.add({x:h+q,y:w-K+q+E}),m.add({x:h+q,y:w+E})):0>=Q&&x>=0?(m.add({x:o+q,y:G+R}),m.add({x:o+q,y:G+K+q+R}),m.add({x:h+q,y:w-K+q-E}),m.add({x:h+q,y:w-E})):Q>=0&&x>=0?(m.add({x:o+q,y:G+R}),m.add({x:o+q,y:G+K-q+R}),m.add({x:h+q,y:w-K-q-E}),m.add({x:h+q,y:w-E})):(m.add({x:o+q,y:G-R}),m.add({x:o+q,y:G+K-q-R}),m.add({x:h+q,y:w-K-q+E}),m.add({x:h+q,y:w+E})):Q>=0&&0>=x?(m.add({x:o+j,y:G+q}),m.add({x:o+F+q+j,y:G+q}),m.add({x:h-F+q-O,y:w+q}),m.add({x:h-O,y:w+q})):0>=Q&&x>=0?(m.add({x:o-j,y:G+q}),m.add({x:o+F+q-j,y:G+q}),m.add({x:h-F+q+O,y:w+q}),m.add({x:h+O,y:w+q})):Q>=0&&x>=0?(m.add({x:o+j,y:G+q}),m.add({x:o+F-q+j,y:G+q}),m.add({x:h-F-q-O,y:w+q}),m.add({x:h-O,y:w+q})):(m.add({x:o-j,y:G+q}),m.add({x:o+F-q-j,y:G+q}),m.add({x:h-F-q+O,y:w+q}),m.add({x:h+O,y:w+q})),d(m,L)}),o("extend.east",function(j,l,H){var h=new b,z=j.s(u)+t(j,H),s=j.s(c),U=W(H,j),x=j._40I instanceof p.Edge,Y=j._41I instanceof p.Edge,K=U.x+(s||x?0:N(H,j._40I)/2),q=U.y,X=C(H,j),a=X.x+(s||Y?0:N(H,j._41I)/2),i=X.y,A=J(K,a)+z;return q>i?(h.add({x:K,y:q+l}),h.add({x:A+l,y:q+l}),h.add({x:A+l,y:i-l}),h.add({x:a,y:i-l})):(h.add({x:K,y:q-l}),h.add({x:A+l,y:q-l}),h.add({x:A+l,y:i+l}),h.add({x:a,y:i+l})),d(h,j)}),o("extend.west",function(U,m,F){var s=new b,T=U.s(u)+t(U,F),z=U.s(c),S=U._40I instanceof p.Edge,j=U._41I instanceof p.Edge,D=W(F,U),_=D.x-(z||S?0:N(F,U._40I)/2),M=D.y,B=C(F,U),H=B.x-(z||j?0:N(F,U._41I)/2),x=B.y,v=R(_,H)-T;return M>x?(s.add({x:_,y:M+m}),s.add({x:v-m,y:M+m}),s.add({x:v-m,y:x-m}),s.add({x:H,y:x-m})):(s.add({x:_,y:M-m}),s.add({x:v-m,y:M-m}),s.add({x:v-m,y:x+m}),s.add({x:H,y:x+m})),d(s,U)}),o("extend.north",function(N,J,Z){var h=new b,D=N.s(u)+t(N,Z),o=N.s(c),B=N._40I instanceof p.Edge,G=N._41I instanceof p.Edge,M=W(Z,N),F=M.x,e=M.y-(o||B?0:n(Z,N._40I)/2),K=C(Z,N),$=K.x,v=K.y-(o||G?0:n(Z,N._41I)/2),P=R(e,v)-D;return F>$?(h.add({y:e,x:F+J}),h.add({y:P-J,x:F+J}),h.add({y:P-J,x:$-J}),h.add({y:v,x:$-J})):(h.add({y:e,x:F-J}),h.add({y:P-J,x:F-J}),h.add({y:P-J,x:$+J}),h.add({y:v,x:$+J})),d(h,N)}),o("extend.south",function(E,$,U){var y=new b,k=E.s(u)+t(E,U),_=E.s(c),o=E._40I instanceof p.Edge,V=E._41I instanceof p.Edge,N=W(U,E),x=N.x,w=N.y+(_||o?0:n(U,E._40I)/2),S=C(U,E),B=S.x,Z=S.y+(_||V?0:n(U,E._41I)/2),X=J(w,Z)+k;return x>B?(y.add({y:w,x:x+$}),y.add({y:X+$,x:x+$}),y.add({y:X+$,x:B-$}),y.add({y:Z,x:B-$})):(y.add({y:w,x:x-$}),y.add({y:X+$,x:x-$}),y.add({y:X+$,x:B+$}),y.add({y:Z,x:B+$})),d(y,E)});var k=function(a,W,E,w,R){if(w.sort(function(C,U){var p=C.getSourceAgent()===W?C.getTargetAgent():C.getSourceAgent(),F=U.getSourceAgent()===W?U.getTargetAgent():U.getSourceAgent(),O=p.p(),S=F.p();if(E===$||E===g){if(O.y>S.y)return 1;if(O.y<S.y)return-1}else{if(O.x>S.x)return 1;if(O.x<S.x)return-1}return Y.sortFunc(C.getId(),U.getId())}),R){for(var L,J,C,Q=a.getSourceAgent(),f=a.getTargetAgent(),r=0;r<w.size();r++){var s=w.get(r);s.getSourceAgent()===Q&&s.getTargetAgent()===f||s.getTargetAgent()===Q&&s.getSourceAgent()===f?(J||(J=new b),J.add(s,0)):J?(C||(C=new b),C.add(s)):(L||(L=new b),L.add(s))}w.clear(),L&&w.addAll(L),J&&w.addAll(J),C&&w.addAll(C)}var l=w.indexOf(a),n=w.size(),v=a.s(h);return{side:E,index:l,size:n,offset:-v*(n-1)/2+v*l}},G=function(Y,P,v,z,x){var a=P.s(A);return k(P,v,z,v.getAgentEdges().toList(function(P){return Y.isVisible(P)&&P.s(A)===a}),x)},E=function(y,i){var p=y.getSourceAgent()===i?y.getTargetAgent():y.getSourceAgent(),C=i.p(),V=p.p(),D=V.x-C.x,o=V.y-C.y;return D>0&&T(o)<=D?g:0>D&&T(o)<=-D?$:o>0&&T(D)<=o?X:L},M=function(d,L,D){var O=L.s(A),P=E(L,D);return k(L,D,P,D.getAgentEdges().toList(function(Z){return d.isVisible(Z)&&Z.s(A)===O&&E(Z,D)===P}))},B=function(P,W){var f=P.getSourceAgent()===W,s=f?P.getTargetAgent():P.getSourceAgent(),e=W.p(),N=s.p();return f?e.y>N.y?L:X:e.x<N.x?g:$},q=function(b,G,I){var J=G.s(A),$=B(G,I);return k(G,I,$,I.getAgentEdges().toList(function(F){return b.isVisible(F)&&F.s(A)===J&&B(F,I)===$}),$===g||$===X)},i=function(i,f){var v=i.getSourceAgent()===f,d=v?i.getTargetAgent():i.getSourceAgent(),C=f.p(),w=d.p();return v?C.x<w.x?g:$:C.y>w.y?L:X},D=function(e,f,x){var U=f.s(A),r=i(f,x);return k(f,x,r,x.getAgentEdges().toList(function(h){return e.isVisible(h)&&h.s(A)===U&&i(h,x)===r}),r===g||r===X)},j=function(w,a,K){var J=w.getSourceAgent(),A=w.getTargetAgent(),S=J.getId()>A.getId(),m=S?A:J,Y=S?J:A,_=m.p(),i=Y.p(),f=K(a,w,m),l=K(a,w,Y),V=w.s(c),E=V?0:N(a,m)/2,r=V?0:N(a,Y)/2,H=V?0:n(a,m)/2,G=V?0:n(a,Y)/2,x=f.offset,e=l.offset,B=f.side,s=l.side,t=new b;return B===L?(t.add({x:_.x+x,y:_.y-H}),t.add({x:_.x+x,y:i.y+e}),s===$?t.add({x:i.x-r,y:i.y+e}):t.add({x:i.x+r,y:i.y+e})):B===X?(t.add({x:_.x+x,y:_.y+H}),t.add({x:_.x+x,y:i.y+e}),s===$?t.add({x:i.x-r,y:i.y+e}):t.add({x:i.x+r,y:i.y+e})):B===$?(t.add({x:_.x-E,y:_.y+x}),t.add({x:i.x+e,y:_.y+x}),s===X?t.add({x:i.x+e,y:i.y+G}):t.add({x:i.x+e,y:i.y-G})):B===g&&(t.add({x:_.x+E,y:_.y+x}),t.add({x:i.x+e,y:_.y+x}),s===X?t.add({x:i.x+e,y:i.y+G}):t.add({x:i.x+e,y:i.y-G})),S&&t.reverse(),d(t,w)};o("ortho2",function(o,E,F){var Y,A,m=o.s(c),r=o.s("edge.ortho"),H=o.getSourceAgent(),w=o.getTargetAgent(),l=H.getId()>w.getId(),T=l?w:H,R=l?H:w,p=T.p(),u=R.p(),J=M(F,o,T),P=M(F,o,R),q=m?0:N(F,T)/2,U=m?0:n(F,T)/2,k=m?0:N(F,R)/2,f=m?0:n(F,R)/2,z=new b,h=J.offset,t=P.offset,G=J.side;return G===g?(Y=u.y>p.y?-h:h,A=p.x+q+(u.x-k-p.x-q)*r,z.add({x:p.x+q,y:p.y+h}),z.add({x:A+Y,y:p.y+h}),z.add({x:A+Y,y:u.y+t}),z.add({x:u.x-k,y:u.y+t})):G===$?(Y=u.y>p.y?-h:h,A=p.x-q-(p.x-q-u.x-k)*r,z.add({x:p.x-q,y:p.y+h}),z.add({x:A-Y,y:p.y+h}),z.add({x:A-Y,y:u.y+t}),z.add({x:u.x+k,y:u.y+t})):G===X?(Y=u.x>p.x?-h:h,A=p.y+U+(u.y-f-p.y-U)*r,z.add({x:p.x+h,y:p.y+U}),z.add({x:p.x+h,y:A+Y}),z.add({x:u.x+t,y:A+Y}),z.add({x:u.x+t,y:u.y-f})):G===L&&(Y=u.x>p.x?-h:h,A=p.y-U-(p.y-U-u.y-f)*r,z.add({x:p.x+h,y:p.y-U}),z.add({x:p.x+h,y:A-Y}),z.add({x:u.x+t,y:A-Y}),z.add({x:u.x+t,y:u.y+f})),l&&z.reverse(),d(z,o)},!0),o("flex2",function(m,E,A){var i,x=m.getSourceAgent(),p=m.getTargetAgent(),Z=x.getId()>p.getId(),R=Z?p:x,s=Z?x:p,e=R.p(),v=s.p(),P=M(A,m,R),k=M(A,m,s),V=m.s(c),Q=m.s("edge.flex")+(P.size-1)/2*m.s(h),C=V?0:N(A,R)/2,f=V?0:n(A,R)/2,z=V?0:N(A,s)/2,J=V?0:n(A,s)/2,S=new b,T=P.offset,U=k.offset,B=P.side;return B===g?(i=v.y>e.y?-T:T,S.add({x:e.x+C,y:e.y+T}),S.add({x:e.x+C+Q+i,y:e.y+T}),S.add({x:v.x-z-Q+i,y:v.y+U}),S.add({x:v.x-z,y:v.y+U})):B===$?(i=v.y>e.y?-T:T,S.add({x:e.x-C,y:e.y+T}),S.add({x:e.x-C-Q-i,y:e.y+T}),S.add({x:v.x+z+Q-i,y:v.y+U}),S.add({x:v.x+z,y:v.y+U})):B===X?(i=v.x>e.x?-T:T,S.add({x:e.x+T,y:e.y+f}),S.add({x:e.x+T,y:e.y+f+Q+i}),S.add({x:v.x+U,y:v.y-J-Q+i}),S.add({x:v.x+U,y:v.y-J})):B===L&&(i=v.x>e.x?-T:T,S.add({x:e.x+T,y:e.y-f}),S.add({x:e.x+T,y:e.y-f-Q-i}),S.add({x:v.x+U,y:v.y+J+Q-i}),S.add({x:v.x+U,y:v.y+J})),Z&&S.reverse(),d(S,m)},!0),o("extend.north2",function(K,f,F){var J=K.getSourceAgent(),S=K.getTargetAgent(),j=J.getId()>S.getId(),B=j?S:J,$=j?J:S,s=B.p(),A=$.p(),i=G(F,K,B,L),g=G(F,K,$,L,!0),w=K.s(c),_=w?0:n(F,B)/2,O=w?0:n(F,$)/2,k=i.offset,t=g.offset,m=K.s(u)+(i.size-1)/2*K.s(h),l=R(s.y-_,A.y-O)-m+(s.x<A.x?k:-k),o=new b;return o.add({x:s.x+k,y:s.y-_}),o.add({x:s.x+k,y:l}),o.add({x:A.x+t,y:l}),o.add({x:A.x+t,y:A.y-O}),j&&o.reverse(),d(o,K)},!0),o("extend.south2",function(v,Z,R){var z=v.getSourceAgent(),j=v.getTargetAgent(),I=z.getId()>j.getId(),O=I?j:z,l=I?z:j,i=O.p(),U=l.p(),E=G(R,v,O,X),t=G(R,v,l,X,!0),o=v.s(c),f=o?0:n(R,O)/2,L=o?0:n(R,l)/2,T=E.offset,M=t.offset,F=v.s(u)+(E.size-1)/2*v.s(h),x=J(i.y+f,U.y+L)+F+(i.x>U.x?T:-T),w=new b;return w.add({x:i.x+T,y:i.y+f}),w.add({x:i.x+T,y:x}),w.add({x:U.x+M,y:x}),w.add({x:U.x+M,y:U.y+L}),I&&w.reverse(),d(w,v)},!0),o("extend.west2",function(C,Y,P){var i=C.getSourceAgent(),m=C.getTargetAgent(),E=i.getId()>m.getId(),S=E?m:i,p=E?i:m,j=S.p(),X=p.p(),O=G(P,C,S,L),A=G(P,C,p,L,!0),D=C.s(c),y=D?0:N(P,S)/2,W=D?0:N(P,p)/2,_=O.offset,x=A.offset,H=C.s(u)+(O.size-1)/2*C.s(h),M=R(j.x-y,X.x-W)-H+(j.y<X.y?_:-_),J=new b;return J.add({x:j.x-y,y:j.y+_}),J.add({x:M,y:j.y+_}),J.add({x:M,y:X.y+x}),J.add({x:X.x-W,y:X.y+x}),E&&J.reverse(),d(J,C)},!0),o("extend.east2",function(Q,S,O){var R=Q.getSourceAgent(),e=Q.getTargetAgent(),$=R.getId()>e.getId(),D=$?e:R,F=$?R:e,B=D.p(),V=F.p(),r=G(O,Q,D,L),_=G(O,Q,F,L,!0),M=Q.s(c),E=M?0:N(O,D)/2,t=M?0:N(O,F)/2,A=r.offset,X=_.offset,g=Q.s(u)+(r.size-1)/2*Q.s(h),w=J(B.x+E,V.x+t)+g+(B.y>V.y?A:-A),P=new b;return P.add({x:B.x+E,y:B.y+A}),P.add({x:w,y:B.y+A}),P.add({x:w,y:V.y+X}),P.add({x:V.x+t,y:V.y+X}),$&&P.reverse(),d(P,Q)},!0),o("v.h2",function(Y,G,_){return j(Y,_,q)},!0),o("h.v2",function(J,b,Y){return j(J,Y,D)},!0)}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);